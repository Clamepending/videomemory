2026-01-21 18:29:26,958 - ModelProviderFactory - INFO - Creating model provider: gemini-2.5-flash (Gemini25FlashProvider)
2026-01-21 18:29:26,989 - GoogleProviders - INFO - Initialized Google GenAI client for gemini-2.5-flash
2026-01-21 18:29:27,002 - werkzeug - WARNING -  * Debugger is active!
2026-01-21 18:29:27,006 - werkzeug - INFO -  * Debugger PIN: 394-331-644
2026-01-21 18:29:34,781 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:29:34] "GET / HTTP/1.1" 200 -
2026-01-21 18:29:34,851 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:29:34] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2026-01-21 18:29:37,519 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:29:38,079 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:29:38,081 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-6' coro=<<async_generator_athrow without __name__>()>>
2026-01-21 18:29:38,089 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:29:38] "POST /chat HTTP/1.1" 200 -
2026-01-21 18:29:50,707 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:29:51,296 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:29:51,296 - google_genai.types - WARNING - Warning: there are non-text parts in the response: ['function_call'], returning concatenated text result from text parts. Check the full candidates.content.parts accessor to get the full model response.
2026-01-21 18:29:52,506 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:29:53,462 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:29:53,465 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-18' coro=<<async_generator_athrow without __name__>()>>
2026-01-21 18:29:53,469 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:29:53] "POST /chat HTTP/1.1" 200 -
2026-01-21 18:30:03,213 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:04,285 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:05,508 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:06,230 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:06,873 - VideoStreamIngestor - INFO - Initialized for camera index=0
2026-01-21 18:30:06,873 - VideoStreamIngestor - INFO - Added task 0 'Watch hands' for camera index=0
2026-01-21 18:30:06,873 - tasks - INFO - [INFO] add_task: Successfully added task, returning result
2026-01-21 18:30:06,874 - VideoStreamIngestor - INFO - Created session video_ingestor_session_0 for camera index=0
2026-01-21 18:30:06,874 - VideoStreamIngestor - INFO - Starting ingestor for camera index=0
2026-01-21 18:30:06,874 - VideoStreamIngestor - INFO - Started 2 processing loops for camera index=0
2026-01-21 18:30:06,874 - VideoStreamIngestor - INFO - Task status: ['process_input_0', 'action_0']
2026-01-21 18:30:07,328 - VideoStreamIngestor - INFO - Started process input loop for camera index=0
2026-01-21 18:30:07,329 - VideoStreamIngestor - INFO - Started action loop for camera index=0
2026-01-21 18:30:07,344 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:07,352 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2026-01-21 18:30:08,069 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:08,069 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-38' coro=<<async_generator_athrow without __name__>()>>
2026-01-21 18:30:08,071 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:30:08] "POST /chat HTTP/1.1" 200 -
2026-01-21 18:30:09,707 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-01-21 18:30:17,922 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:18,958 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:18,995 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:19,645 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:19,647 - VideoStreamIngestor - INFO - Removed task 'Watch hands' for camera index=0
2026-01-21 18:30:19,648 - TaskManager - INFO - VideoStreamIngestor for io_id=9856d608 has no tasks remaining. Deleting ingestor.
2026-01-21 18:30:19,648 - VideoStreamIngestor - INFO - Stopping ingestor for camera index=0
2026-01-21 18:30:19,648 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-51' coro=<VideoStreamIngestor.stop() done, defined at /Users/mark/Desktop/projects/videomemory/videomemory/system/stream_ingestors/video_stream_ingestor.py:576> exception=RuntimeError('Event loop is closed')>
Traceback (most recent call last):
  File "/Users/mark/Desktop/projects/videomemory/videomemory/system/stream_ingestors/video_stream_ingestor.py", line 590, in stop
    task.cancel()
    ~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 833, in call_soon
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
2026-01-21 18:30:19,684 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:20,281 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:20,283 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-58' coro=<<async_generator_athrow without __name__>()>>
2026-01-21 18:30:20,289 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:30:20] "POST /chat HTTP/1.1" 200 -
2026-01-21 18:30:27,069 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:27,835 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:27,861 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:27,864 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task cancelling name='process_input_0' coro=<VideoStreamIngestor._process_input() done, defined at /Users/mark/Desktop/projects/videomemory/videomemory/system/stream_ingestors/video_stream_ingestor.py:144> wait_for=<Future cancelled>>
2026-01-21 18:30:27,864 - VideoStreamIngestor - ERROR - Error executing action for camera index=0: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
GeneratorExit

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mark/Desktop/projects/videomemory/videomemory/system/stream_ingestors/video_stream_ingestor.py", line 233, in _action_loop
    action = await asyncio.wait_for(
             ^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 188, in get
    getter.cancel()  # Just in case getter is not done yet.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 833, in call_soon
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
2026-01-21 18:30:27,866 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='action_0' coro=<VideoStreamIngestor._action_loop() done, defined at /Users/mark/Desktop/projects/videomemory/videomemory/system/stream_ingestors/video_stream_ingestor.py:225> wait_for=<Future cancelled>>
2026-01-21 18:30:28,554 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:28,557 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-70' coro=<<async_generator_athrow without __name__>()>>
2026-01-21 18:30:28,562 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:30:28] "POST /chat HTTP/1.1" 200 -
2026-01-21 18:30:32,716 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:34,058 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:34,061 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-75' coro=<<async_generator_athrow without __name__>()>>
2026-01-21 18:30:34,065 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:30:34] "POST /chat HTTP/1.1" 200 -
2026-01-21 18:30:37,035 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:37,861 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:37,863 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-80' coro=<<async_generator_athrow without __name__>()>>
2026-01-21 18:30:37,869 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:30:37] "POST /chat HTTP/1.1" 200 -
2026-01-21 18:30:49,926 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:30:49] "GET / HTTP/1.1" 200 -
2026-01-21 18:30:55,480 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:30:56,312 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:30:56,316 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-85' coro=<<async_generator_athrow without __name__>()>>
2026-01-21 18:30:56,321 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:30:56] "POST /chat HTTP/1.1" 200 -
2026-01-21 18:31:03,251 - google_adk.google.adk.models.google_llm - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2026-01-21 18:31:04,071 - google_adk.google.adk.models.google_llm - INFO - Response received from the model.
2026-01-21 18:31:04,075 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-90' coro=<<async_generator_athrow without __name__>()>>
2026-01-21 18:31:04,081 - werkzeug - INFO - 127.0.0.1 - - [21/Jan/2026 18:31:04] "POST /chat HTTP/1.1" 200 -
